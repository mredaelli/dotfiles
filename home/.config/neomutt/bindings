bind  generic,index,pager,index q exit
macro generic,index,pager Q "qqq"

# Reload configuration
macro generic,index,pager,editor \Cr "<enter-command>source ~/.config/neomutt/muttrc<enter><check-stats>" "Reload mutt's configuration file"


macro index,pager _mr "<tag-prefix><clear-flag>O<previous-entry><tag-prefix><clear-flag>N<previous-entry>" "Mark read"

macro index,pager _cy "<enter-command>set confirmappend=yes delete=ask-yes<enter>" "Ask confirmation" 
macro index,pager _cn "<enter-command>set confirmappend=no delete=yes<enter>" "Don't ask confirmation" 
# Macros for switching accounts
macro index,pager 1 "<sync-mailbox><enter-command>source ~/.config/neomutt/fast<enter><change-folder>!<enter><check-stats>"
macro index,pager 2 "<sync-mailbox><enter-command>source ~/.config/neomutt/mredaelli<enter><change-folder>!<enter><check-stats>"

macro index,pager 4 "<sync-mailbox><enter-command>source ~/.config/neomutt/mredaelli2<enter><change-folder>!<enter><check-stats>"
macro index,pager 5 "<sync-mailbox><enter-command>source ~/.config/neomutt/international<enter><change-folder>!<enter><check-stats>"

macro index,pager 7 "<sync-mailbox><enter-command>source ~/.config/neomutt/perizie<enter><change-folder>!<enter><check-stats>"
macro index,pager 8 "<sync-mailbox><enter-command>source ~/.config/neomutt/cesgraf<enter><change-folder>!<enter><check-stats>"

# mu integration
macro index <F8> "<shell-escape>mu find --clearlinks --format=links --linksdir=~/Maildir/search " \
                                       "mu find"
macro index <F9> "<change-folder-readonly>~/Maildir/search" \
                                       "mu find results"

macro index \\ "<shell-escape>mu4mutt<enter><change-folder-readonly>~/Maildir/search<enter>"  "mu find and show"                                       


# Editor
bind editor <Tab> complete-query
bind editor <Up> history-up
bind editor <Down> history-down
bind editor <Home> bol
bind editor <End> eol
bind editor <Left> backward-char
bind editor <Right> forward-char
bind editor \Cdw kill-word
bind editor \Cdd kill-line
bind editor \Cw forward-word
bind editor \Cb backward-word


bind generic,index t tag-entry
bind generic,index \; tag-prefix
bind index Tt tag-thread
bind index Tp tag-pattern
bind index Ts tag-subthread

bind attach <return> view-mailcap
bind attach <space> view-mailcap
bind browser <space> select-entry


# moving around
#
macro index,pager i  "<change-folder>!<enter><buffy-list><check-stats>" "open inbox"
macro index,pager gi  "<change-folder>!<enter><buffy-list><check-stats>" "open inbox"
macro index,pager gd  "<change-folder>+postponed<enter><buffy-list><check-stats>" "open drafts"
macro index,pager ga  "<change-folder>+Archive<enter><buffy-list><check-stats>" "open archive"
macro index,pager gs  "<change-folder><<enter><buffy-list><check-stats>" "open sent"
macro index,pager g-  "<change-folder>-<enter><buffy-list><check-stats>" "open last"
macro index,pager gj "<change-folder>+spam<enter><buffy-list><check-stats>"      "open junk mail (spam)"
macro index,pager gr "<change-folder>^<enter><buffy-list><check-stats>"          "refresh folder"

bind index \Cm change-folder 
macro index M "<change-folder>?<Tab>" "Go back to the list of mailboxes"

macro index,pager a "_mr_cn<tag-prefix><save-message>=Archive<enter><sync-mailbox>_cy" "Archive" 
macro index,pager ma "_mr_cn<tag-prefix><save-message>=Archive<enter><sync-mailbox>_cy" "move to archive" 
macro index,pager mi "_mr_cn<tag-prefix><save-message>!<enter><sync-mailbox>_cy" "move to inbox" 
macro index,pager md "_mr_cn<tag-prefix><save-message>+postponed<enter><sync-mailbox>_cy" "move to draft" 
macro index,pager ms "_mr_cn<tag-prefix><save-message><<enter><sync-mailbox>_cy" "move to sent" 
macro index,pager mj "_mr_cn<tag-prefix><save-message>+spam<enter><sync-mailbox>_cy" "move to spam" 


# Limit messages quickly using ' + key.
macro index \'d  "<limit>~D<enter>"       "limit to deleted messages"
macro index \'f  "<limit>~F<enter>"       "limit to flagged messages"
macro index \'D  "<limit>~=<enter>"       "limit to duplicate messages"
macro index \'n  "<limit>~N|~O<enter>"    "limit to new messages"
macro index \'s  "<limit>~g|~G<enter>"    "limit to signed or encrypted messages"
macro index \'u  "<limit>!~Q<enter>"      "limit to unreplied messages"
macro index \'\' "<limit>~A<enter>"       "reset all limits"


bind generic,index,pager <Up> previous-entry
bind generic,index,pager <Down> next-entry
bind generic,index,pager k previous-entry
bind generic,index,pager j next-entry
bind generic,index,pager K half-up
bind generic,index,pager J half-down
bind generic,index <Space> select-entry

bind generic,pager,index ] next-unread 
bind generic,pager,index [ previous-unread

bind generic,index,pager / search
bind generic,index,pager : enter-command

## Make quick html view macro
bind index,pager v  view-attachments
macro index,pager V "<view-attachments><search>html<enter><view-mailcap><exit>"

### Browser bindings ###
## Browser is used when viewing the list of mailboxes
bind browser \Cr  check-new
bind browser N select-new

# sidebar
bind index,pager S sidebar-toggle-visible
bind index,pager H sidebar-prev
bind index,pager L sidebar-next
macro index,pager <Enter> "<sidebar-open><check-stats>" "open folder from sidebar"
macro index,pager <Return> "<sidebar-open><check-stats>" "open folder from sidebar"


### Index bindings ###



# Reply/forward/etc.
bind index,pager c mail 
bind index,pager r reply
bind index,pager R group-reply
bind index,pager f forward-message

# Delete / junk
bind index,pager d delete-message
bind index,pager D delete-thread

bind index <Space> display-message

macro index,pager l "<pipe-message> urlscan<Enter>" "call urlscan to extract URLs out of a message"
macro index,pager \Ct "<pipe-message> mu4mutt_thread<Enter><change-folder-readonly>~/Maildir/search<enter>" "show all messages in thread"

bind index,pager \Cs sync-mailbox


# Odds and ends
bind  index @ display-address
bind  index o sort-mailbox
bind  index,pager s save-message
bind  index,pager | pipe-message
bind  index,pager u undelete-message
bind  index,pager n next-unread
macro index N "<next-unread-mailbox><enter><next-new-then-unread><enter>" "Go to new mail anywhere"

# Setting/clearing flags
bind  index,pager W      clear-flag
bind  index,pager w      set-flag
#macro index,pager ! wN  "Mark email as unread"
#bind index,pager ! toggle-new

bind  index x toggle-read

#bind  index P previous-new-then-unread
#bind  index N next-new-then-unread
bind  index,pager N jump
#macro index r WN<up>n   "Mark as read, then go to next"
#bind  index t read-thread
#macro index T tn


### Pager bindings ###
## Pager is used on the 'help' screen, as well as when reading emails
#bind pager <Up>   previous-line
#bind pager <Down> next-line
#bind pager k   previous-line
#bind pager l next-line

